## Step 2: Set Up the XML file

1. Go to the **SampleGadget.xml** file that you had opened in your text editor.
As you can see, the SampleGadget.xml file is pretty bare and doesn't contain any HTML in the body. So, let's start adding the necessary elements and HTML to the file.

1. You will begin with the title of the gadget. This title will be shown in the title bar when the gadget is loaded on the Finesse Agent Desktop. Add the `<ModulePrefs>` element containing the title attribute within the `<Module>` element:

 ```xml
<Module>
        <ModulePrefs title="Sample Gadget">
        </ModulePrefs>
</Module>
```
 Note: The title can also be changed dynamically by using the OpenSocial gadget JavaScript API `gadgets.window.setTitle(title)`.

1. Finesse depends on few gadget features in order to work properly. Within the `<ModulePrefs>` element, add these features by adding the following `<Require>` element(s):

 ```xml
<ModulePrefs title="Sample Gadget">
        <Require feature="pubsub-2" />
        <Require feature="loadingindicator"/>
        <Require feature="dynamic-height" />
    </ModulePrefs>
```

 * The `pubsub-2` feature is a Finesse required ModulePref that allows the gadget to load in the OpenAjax Hub.
 * The `loadingindicator` feature is a Finesse recommended ModulePref to give a better user experience by displaying a loading message over the gadget while it is being load.
 * The `dynamic-height` feature is required if you want to use the OpenSocial gadget JavaScript API `gadgets.window.adjustHeight()` to dynamically resize the gadget's height to fit the contents.

1. In a later step, you will be building the import statement to use the Finesse JavaScript library. This will require you to build the absolute URL where the library is hosted, which is the Finesse server in this case. The Finesse container contains this information and you can get it by adding these `<UserPref>` element(s) within the `<Module>` element:

 ```xml
<Module>
        <ModulePrefs title="Sample Gadget">
            <Require feature="pubsub-2" />
            <Require feature="loadingindicator" />
            <Require feature="dynamic-height" />
        </ModulePrefs>
        <UserPref name="scheme" display_name="scheme" default_value=""/>
        <UserPref name="host" display_name="host" default_value=""/>
        <UserPref name="hostPort" display_name="hostPort" default_value=""/>
        ...
</Module>
```

 The user will not be prompted for these user preferences because the Finesse container will automatically set these values when the gadget is created.

1. Add the CSS styling for the gadget by importing the CSS file after the `<!DOCTYPE html>` element:

 ```xml
<link rel="stylesheet" href="SampleGadget.css" type="text/css" />
```

1. In order to use the Finesse JavaScript Library, you must import it. Due to the library's dependency on jQuery, you must import jQuery before importing the Finesse library. Import the Finesse JavaScript Library after the CSS styling.

 You will notice that the UserPref substitution variables (\_\_UP\_scheme, \_\_UP\_host, and \_\_UP\_hostPort) are being used. This will populate these variables with the scheme, host and host port of the Finesse Agent Desktop, which would result in the absolute URL of the jquery.min.js and finesse.js files. As mentioned earlier, these UserPref variables are automatically populated:

 ```xml
<script type="text/javascript" src="__UP_scheme__://__UP_host__:__UP_hostPort__/desktop/assets/js/jquery.min.js"></script>
<script type="text/javascript" src="__UP_scheme__://__UP_host__:__UP_hostPort__/desktop/assets/js/finesse.js"></script>
```

1. Now that the Finesse JavaScript library is imported, you can import the business logic of the gadget. Be aware that the order of the import statements matter.

 ```xml
<script type="text/javascript" src="SampleGadget.js"></script>
```

1. Then, add the HTML for the gadget by adding the following within the `<body>` element:

 ```xml
<div>
        <fieldset id="userfieldset" class="outline">
            <legend>User</legend>
            <div><b> User ID: </b><span id="userId"></span></div>
            <div><b> First Name: </b><span id="firstName"></div>
            <div><b> Last Name: </b><span id="lastName"></div>
            <div><b> Role: </b><span id="userRole"></div>
            <div><b> Extension: </b><span id="extension"></div>
            <div><b> Team ID: </b><span id="teamId"></div>
            <div><b> Team Name: </b><span id="teamName"></div>
            <div><b> Current User State: </b><span id="userState"></div>
            <br>
            <div id="goReady">
                <button onClick="finesse.modules.SampleGadget.setUserState('READY');">Change state to READY</button>
            </div>
            <div id="goNotReady">
                <button onClick="finesse.modules.SampleGadget.setUserState('NOT_READY');">Change state to NOT READY</button>
            </div>
        </fieldset>
</div>
```

 This is a simple gadget that shows the User information and buttons to set the User state. The business logic that you will be adding in the next steps will populate these fields with the correct values from the User object. 

 Note: For this lab, for simplicity, reason codes will not be used. If there are reason codes configured on the Finesse system, you will get an error if you click the Not Ready button.
 
1. Finally, call the gadget init function from the SampleGadget.js file, which you will be writing in a later step. The code in the onConnect function is executed by the OpenSocial container when the gadget connects to the PubSub messaging hub.

 ```xml
<script type="text/javascript">
        gadgets.HubSettings.onConnect = function () {
            finesse.modules.SampleGadget.init();
        };
    </script>
```